(()=>{var e={739:(e,s,t)=>{const r=t(185),a=process.env.DB_URL.replace("<username>",process.env.DB_USER).replace("<password>",process.env.DB_PASS);e.exports=async()=>{try{await r.connect(a)}catch(e){throw e}}},218:(e,s,t)=>{const r=t(406),a=t(344);e.exports=async(e,s)=>{const{email:t,password:o}=e.body,n=[];if(["email","password"].forEach((s=>{const t=((e,s)=>{switch(e){case"email":if(!s)return"Email is required.";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s))return"Please enter a valid email address";break;case"password":if(!s)return"Password is required."}})(s,e.body[s]);t&&n.push(t)})),n.length>0)return s.status(400).json({status:"Failed",error:n});try{const e=await r.findOne({$or:[{email:t}]});if(!e)return s.status(400).json({status:"Failed",error:"User with this email does not exist"});if(!await e.correctPassword(o,e.password))return s.status(401).json({status:"failed",message:"Invalid password"});const n=(i=t,a.sign({id:i},process.env.JWT_SECRET,{expiresIn:process.env.JWT_EXPIRES_IN}));s.cookie("token",n,{httpOnly:!0,secure:!0,sameSite:"Strict",maxAge:36e5}),s.status(201).json({status:"Success",message:"User logged in successfully",token:n})}catch(e){s.status(500).json({status:"Failed",error:e.message})}var i}},89:e=>{e.exports=async(e,s)=>{const t=e.cookies.token;if(!t)return s.status(401).json({message:"Unauthorized"});try{const e=jwt.verify(t,process.env.JWT_SECRET);s.json({message:`Welcome ${e.username}`})}catch(e){s.status(401).json({message:"Unauthorized"})}}},318:(e,s,t)=>{const r=t(406),a=t(344);e.exports=async(e,s)=>{const{firstName:t,lastName:o,email:n,password:i,cpassword:c}=e.body,u=[];if(["firstName","lastName","email","password","cpassword"].forEach((s=>{const t=((e,s,t)=>{switch(e){case"firstName":if(!s||""===s.trim())return"First name is required";break;case"lastName":if(!s||""===s.trim())return"Last name is required";break;case"email":if(!s)return"Email is required.";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s))return"Please enter a valid email address";break;case"password":if(!s||s.length<8||!/[A-Z]/.test(s)||!/[a-z]/.test(s)||!/[0-9]/.test(s)||!/[!@#$%^&*]/.test(s))return"Password must be at least 8 characters long and include at least one uppercase letter, one lowercase letter, one digit, and one special character";break;case"cpassword":if(!s)return"Confirm password is required";if(s!==t)return"Passwords does not match";break;default:return null}})(s,e.body[s],i);t&&u.push(t)})),u.length>0)return s.status(400).json({status:"Failed",error:u});try{if(await r.findOne({$or:[{email:n}]}))return s.status(400).json({status:"Failed",error:"User with this email or username already exists"});const e=new r({firstName:t,lastName:o,email:n,password:i,cpassword:c});await e.save();const u=(l=e.email,a.sign({id:l},process.env.JWT_SECRET,{expiresIn:process.env.JWT_EXPIRES_IN}));s.status(201).json({status:"Success",message:"User saved successfully",user:e,token:u})}catch(e){s.status(500).json({staus:"Failed",error:e.message})}var l}},471:(e,s,t)=>{const r=t(406);s.getAllUser=async(e,s)=>{console.log("users");const{username:t,email:a}=e.query;let o=JSON.stringify(e.query);o=o.replace(/\b gte|gt|lte|lt \b/g,(e=>`$${e}`)),console.log("queryStr-----\n",o),console.log("req-----------\n",t,a);const n=await r.find(JSON.parse(o));s.status(200).json({status:"success",data:n})}},300:(e,s,t)=>{const r=t(773),a=r.createLogger({level:"info",format:r.format.combine(r.format.timestamp({format:"YYYY-MM-DD HH:mm:ss"}),r.format.errors({stack:!0}),r.format.splat(),r.format.json()),defaultMeta:{service:"Invo Manage"},transports:[new r.transports.File({filename:"error.log",level:"error"}),new r.transports.File({filename:"combined.log"})]});e.exports=a},553:(e,s,t)=>{const r=t(344);s.auth=(e,s,t)=>{const a=e.header("Token");if(!a)return s.status(401).json({status:"failed",message:"token is not found for authorization",statusCode:401});const o=r.decode(a);console.log(o),t()}},406:(e,s,t)=>{const r=t(185),a=t(96),o=new r.Schema({firstName:{type:String,required:!0},lastName:{type:String},email:{type:String,required:!0,validate:{validator:e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),message:"Please enter a valid email address"},unique:[!0,"user already exist"]},password:{type:String,required:!0,validate:{validator:e=>!(e.length<8||!/[A-Z]/.test(e)||!/[a-z]/.test(e)||!/[0-9]/.test(e)||!/[!@#$%^&*]/.test(e)),message:"Password must be at least 8 characters long and include at least one uppercase letter, one lowercase letter, one digit, and one special character."}},cpassword:{type:String,required:!0}},{timestamps:!0});o.methods.correctPassword=async function(e,s){return a.compare(e,s)},o.pre("save",(async function(e){const s=this;if(!s.isModified("password"))return e();try{const t=await a.genSalt(8);s.password=await a.hash(s.password,t),s.cpassword=void 0,e()}catch(s){e(s)}}));const n=r.model("User",o);e.exports=n},322:(e,s,t)=>{const r=t(860),a=t(409),o=r.Router();o.use("/",a),e.exports=o},409:(e,s,t)=>{const{Router:r}=t(860),a=r(),o=t(471),n=t(318),i=t(218),c=t(89);a.post("/signup",n),a.get("/protected",c),a.post("/login",i),a.get("/getAllUser",o.getAllUser),e.exports=a},96:e=>{"use strict";e.exports=require("bcrypt")},582:e=>{"use strict";e.exports=require("cors")},142:e=>{"use strict";e.exports=require("dotenv")},860:e=>{"use strict";e.exports=require("express")},344:e=>{"use strict";e.exports=require("jsonwebtoken")},185:e=>{"use strict";e.exports=require("mongoose")},773:e=>{"use strict";e.exports=require("winston")}},s={};function t(r){var a=s[r];if(void 0!==a)return a.exports;var o=s[r]={exports:{}};return e[r](o,o.exports,t),o.exports}(()=>{const e=t(860);t(142).config();const s=t(739),r=e(),a=t(185),o=t(582),n=t(300),i=t(322),{auth:c}=t(553);r.use(e.json()),r.use(o()),r.use("/",i),r.get("/health",(async(e,s)=>{const t=a.STATES[a.connection.readyState];if("connected"===t)n.info(`mongoDb connection: up, ${t}`),s.status(200).json({status:"up",dbState:t});else{const e=process.env.DB_URL.replace("<username>",process.env.DB_USER).replace("<password>",process.env.DB_PASS);n.info(`mongoDb connection: down, ${t}`),s.status(500).json({status:"down",dbState:t,PORT:e})}}));const u=process.env.PORT||7e3;r.listen(u,(async()=>{try{await s(),console.log("Database connection has been established"),console.log(`Server is running in the port : ${u}`)}catch(e){console.log(`Somthing went wrong: ${e}`)}}))})()})();